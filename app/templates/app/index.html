<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Twitter Parser</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
</head>
<body>
    <div class="row">
        <div class="col-lg-3 col-md-3 col-sm-0 col-xs-0"></div>
        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 ">
            <form>
                <div class="form-group">
                    <input type="text" class="form-control" id="username-input" placeholder="Username">
                </div>
                <div class="form-group">
                    <input id="username-submit" type="button" value="Send" class="btn btn-primary form-control"/>

                </div>
            </form>
            <div id="tweets">



            </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-0 col-xs-0"></div>
    </div>
    
</body>
<script>

    var web_socket = new WebSocket('ws://' + window.location.host + '/');
    // console.log(web_socket)

    web_socket.onmessage = function(e) {
        console.log(e.data)
        var data = JSON.parse(e.data);
        var message = data['text'];
        // document.querySelector('#chat-log').value += (message + '\n');
    };

    web_socket.onclose = function(e) {
        web_socket = new WebSocket('ws://' + window.location.host + '/');

    };

    document.querySelector('#username-input').focus();
    document.querySelector('#username-input').onkeyup = function(e) {
        if (e.keyCode === 13) {  // enter, return
            document.querySelector('#username-submit').click();
        }
    };

    document.querySelector('#username-submit').onclick = function(e) {
        var usernameInputDom = document.querySelector('#username-input');
        var username = usernameInputDom.value;
        if(username == '') return 0;
        
        
        web_socket.send(JSON.stringify({
            'username': username
        }));

        // usernameInputDom.value = '';


    };
</script>
</html>